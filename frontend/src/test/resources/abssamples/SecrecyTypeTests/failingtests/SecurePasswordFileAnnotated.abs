module PasswordFileExample;

class SecurePasswordFile(List<Int> in_names, List<Int> in_passwords) {

    List<Int> names = in_names;
    [Secrecy: High] List<Int> passwords = in_passwords;

    //meant to fail | password (should be High) in passwords:High =>
    //possibleUserPwd = nth(passwords, i); => Leaks password[i] to possibleUserPwd:Low
    [Secrecy: High] Bool check(Int user,[Secrecy: High] Int password) {
        Int i = 0;
        [Secrecy: High] Bool result = False;
        Int possibleUserName = 0;
        Int possibleUserPwd = 0;

        while (i < length(names)) {
            possibleUserName = nth(names, i);
            possibleUserPwd = nth(passwords, i);

            if(possibleUserName == user && possibleUserPwd == password) {
                result = True;
            }

            i = i+1;
        }
        
        return result;
    }
}