module Mini;

interface AliasingExamplesI {
    Unit setX([Secrecy: High] Int v);
    [Secrecy: High] Int getX();
    [Secrecy: High] Int secure_1(AliasingExamplesI a, AliasingExamplesI b,[Secrecy: High] Int h);
    Int insecure_1(AliasingExamplesI a, AliasingExamplesI b,[Secrecy: High] Int h);

}

class AliasingExamples implements AliasingExamplesI {
    [Secrecy: High]Int x = 0;

    //meant to pass
    Unit setX([Secrecy: High] Int v) {
        x = v;
        return Unit;
    }

    //meant to pass
    [Secrecy: High] Int getX() {
        return x;
    }

    //meant to pass
    [Secrecy: High] Int secure_1(AliasingExamplesI a, AliasingExamplesI b,[Secrecy: High] Int h) {
        a.setX(h);
        return b.getX();
    }

    //meant to fail | h:High =>
    //The variable x of the AliasingExamples class has to be High to allow being assigned a high value (like h)
    //But thus can't be returned for a return that was supposed to be insecure_1():Low
    Int insecure_1(AliasingExamplesI a, AliasingExamplesI b,[Secrecy: High] Int h) {
        a.setX(h);
        return b.getX();
    }
}
